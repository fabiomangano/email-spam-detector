## üìä Metriche di Analisi Email per Rilevamento Spam

| Metrica                     | Tipo      | Descrizione                                                  | Perch√© √® utile                                         | Come calcolare il valore                                 |
| --------------------------- | --------- | ------------------------------------------------------------ | ------------------------------------------------------ | -------------------------------------------------------- |
| bodyLength                  | number    | Lunghezza totale di `plainText` + `htmlText`                 | Email troppo corte o troppo lunghe possono essere spam | Somma delle lunghezze dei due campi                      |
| numLinks                    | number    | Numero di link presenti nel corpo dell‚Äôemail                 | Email con troppi link sono spesso sospette             | Regex su `http`/`https` negli `a[href]` o testo          |
| linkRatio                   | number    | Rapporto `numLinks / bodyLength`                             | Misura la densit√† dei link                             | `numLinks / bodyLength`                                  |
| numImages                   | number    | Numero immagini nel contenuto HTML                           | Spam pubblicitario spesso contiene solo immagini       | Conta i tag `<img>` nel `htmlText`                       |
| hasTrackingPixel            | boolean   | Presenza di pixel invisibile da 1x1 px                       | Tecnica di tracciamento usata nello spam               | `<img>` con width/height pari a 1                        |
| hasAttachments              | boolean   | Se sono presenti allegati                                    | Malware o spam spesso contengono allegati              | `attachments.length > 0`                                 |
| numAttachments              | number    | Numero di allegati                                           | Allegati multipli sospetti                             | Lunghezza dell'array `attachments`                       |
| attachmentTypes             | string\[] | Tipi MIME degli allegati                                     | Alcuni MIME sono indicatori di spam                    | MIME type da metadati `attachments`                      |
| spfResult                   | string    | Valore SPF da Authentication-Results                         | SPF fail pu√≤ indicare spoofing                         | Parsare header `Authentication-Results`                  |
| dkimResult                  | string    | Valore DKIM                                                  | DKIM fail ‚Üí contenuto falsificato                      | Parsare header `Authentication-Results`                  |
| dmarcResult                 | string    | Valore DMARC                                                 | DMARC fail ‚Üí mittente sospetto                         | Parsare header `Authentication-Results`                  |
| ipSender                    | string    | IP del mittente (ultimo header Received valido)              | Usato per controlli RBL e geolocalizzazione            | Estrazione da header `Received`                          |
| isHtmlOnly                  | boolean   | Email solo in formato HTML                                   | Tecnica per nascondere contenuti reali                 | Presente `htmlText` ma assente `plainText`               |
| numDomains                  | number    | Domini diversi tra i link                                    | Spam spesso punta a molti domini                       | Estrai domini da tutti gli URL                           |
| replyToDiffersFromFrom      | boolean   | `Reply-To` diverso da `From`                                 | Tecnica comune nel phishing                            | Confronta `from.address` e `replyTo.address`             |
| numReceivedHeaders          | number    | Numero di hop nei `Received:`                                | Troppi passaggi possono mascherare provenienza         | Conta i blocchi `Received:` nei header                   |
| hasOutlookReceivedPattern   | boolean   | Verifica presenza server Outlook nella catena SMTP           | Aiuta a distinguere flussi legittimi (es. MS Exchange) | Regex su domini tipo `*.outlook.com` nei `Received`      |
| xMailerBrand                | string    | Valore di `X-Mailer` o `User-Agent`                          | Identifica software noto per spam                      | Estrai header `X-Mailer`, `User-Agent`, `X-Mailer`       |
| missingDateHeader           | boolean   | Verifica assenza o anomalia header `Date`                    | Email malformate sono sospette                         | Assenza o data invalida                                  |
| fromNameSuspicious          | boolean   | Nome mittente strano (tutto maiuscolo o generico)            | Maschera l‚Äôidentit√† reale                              | Regex su `From.name`                                     |
| uppercaseRatio              | number    | Percentuale di testo in MAIUSCOLO nel `plainText`            | Comunicazione aggressiva/spam                          | Conta lettere maiuscole e confronta con lunghezza totale |
| excessiveExclamations       | boolean   | Molti `!` consecutivi nel testo                              | Tecnica classica per attirare attenzione               | Regex su `!{3,}`                                         |
| containsUrgencyWords        | boolean   | Parole tipo ‚Äúurgente‚Äù, ‚Äúobbligatorio‚Äù, ‚Äúimmediato‚Äù           | Linguaggio pressante tipico di phishing/scam           | Dizionario di parole e scan su testo                     |
| containsElectionTerms       | boolean   | Parole chiave elettorali: ‚Äúcabina‚Äù, ‚Äúvoto‚Äù, ‚Äúdelegati‚Äù       | Campagne massive o phishing tematico                   | Dizionario contestuale                                   |
| containsObfuscatedText      | boolean   | Caratteri Unicode, simboli rari, HTML offuscato              | Usato per evadere filtri                               | Regex Unicode o charCode fuori ASCII                     |
| numExternalDomains          | number    | Conta domini esterni nei link                                | Molti domini ‚Üí probabilmente redirect o phishing       | Estrai domini e raggruppa                                |
| linkDisplayMismatch         | boolean   | Link testuale ‚â† URL reale                                    | Tecnica di inganno                                     | Confronta testo del link vs href                         |
| containsShortenedUrls       | boolean   | Usa accorciatori come `bit.ly`, `t.co`, ecc.                 | Maschera reale destinazione                            | Regex su noti servizi di short URL                       |
| usesEncodedUrls             | boolean   | URL con encoding percentuale (%3D, %2F, ecc.)                | Pu√≤ mascherare redirect o link fraudolenti             | Cerca percent-encoding nei link                          |
| linkToImageRatio            | number    | `numLinks / numImages`                                       | Troppi link rispetto a contenuti visivi                | Calcola il rapporto numerico                             |
| hasMixedContentTypes        | boolean   | Email ha tipi MIME misti                                     | Struttura complessa pu√≤ nascondere contenuti           | Presenza di `multipart/mixed` o simili                   |
| hasNestedMultipart          | boolean   | MIME annidati (multipart dentro multipart)                   | Pu√≤ mascherare allegati o codice                       | Analisi della struttura MIME                             |
| boundaryAnomaly             | boolean   | Boundary MIME troppo lunghi o casuali                        | Segnale di generazione automatica                      | Lunghezza e pattern dei boundary MIME                    |
| hasFakeMultipartAlternative | boolean   | MIME `alternative` ma manca il `text/plain`                  | Finge compatibilit√† ma nasconde contenuti              | MIME parsing strutturato                                 |
| fromDomainIsDisposable      | boolean   | Dominio del mittente √® noto come temporaneo (es. mailinator) | Email usa mittenti temporanei                          | Confronto con lista domini usa-e-getta                   |
| similarEmailsInWindow       | number    | Numero email simili in breve tempo                           | Attacco massivo o phishing burst                       | Hash su `from+subject` in finestra temporale             |
| campaignIdentifierPresent   | boolean   | Presenza header `X-RPCAMPAIGN`, `List-*`, `Feedback-ID`      | Indica mailing list, newsletter o campagne             | Presenza nei metadati                                    |
| containsFeedbackLoopHeader  | boolean   | Header per loop FBL (Feedback-Loop)                          | Email commerciale da provider autoregolamentato        | Es. `X-CSA-Complaints`                                   |
| sentToMultiple              | boolean   | Email inviata a pi√π destinatari visibili (To, Cc)            | Non √® una comunicazione personale                      | Analisi `To` e `Cc` array                                |
